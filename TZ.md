# Техническое задание: movie-emotion - Сервис подбора фильмов по эмоциональному запросу клиента

## 1. Цель проекта
Создание веб-сервиса для подбора фильмов на основе эмоционального запроса пользователя. Система анализирует эмоциональный профиль фильмов (веселье, грусть, напряжение и т.д.) и рекомендует кино, соответствующее текущему настроению или желаемому эмоциональному запросу пользователя. Сервис также позволяет подписываться на уведомления о новых фильмах с определенным эмоциональным профилем.

## 2. Роли пользователей
- **Гость**: Просмотр каталога фильмов, использование базового поиска по эмоциям
- **Зарегистрированный пользователь**: 
  - Создание персональных подборок фильмов
  - Настройка подписок на эмоциональные категории
  - Получение уведомлений о новых фильмах
  - Сохранение истории поиска
- **Администратор**: Полное управление контентом, пользователями, модерация

## 3. Модели данных

### Модель 1: Film (Фильм)
**Описание**: Основная сущность - кинопроизведение с эмоциональным профилем
**Поля**:
- `title` (CharField): Название фильма
- `description` (TextField): Описание
- `year` (IntegerField): Год выпуска
- `duration` (IntegerField): Продолжительность в минутах
- `poster` (ImageField): Постер фильма
- `country` (CharField): Страна производства
- `director` (CharField): Режиссер
- `is_published` (BooleanField): Опубликован ли фильм
- `created_at` (DateTimeField): Дата добавления

### Модель 2: Emotion (Эмоция)
**Описание**: Категория эмоций, которые могут вызывать фильмы
**Поля**:
- `name` (CharField): Название эмоции (радость, грусть, страх, и так далее)
- `slug` (SlugField): URL-идентификатор
- `description` (TextField): Описание эмоционального состояния
- `color` (CharField): Цвет для визуализации (HEX)
- `icon` (CharField): Название иконки (FontAwesome)

### Модель 3: FilmEmotionRating (Оценка эмоционального воздействия фильма)
**Описание**: Связующая модель для оценки интенсивности эмоций в фильме
**Поля**:
- `film` (ForeignKey to Film): Ссылка на фильм
- `emotion` (ForeignKey to Emotion): Ссылка на эмоцию
- `intensity` (IntegerField): Интенсивность эмоции (1-10)
- `rated_by` (ForeignKey to User): Кто оценил (админ/эксперт)

### Модель 4: UserProfile (Профиль пользователя)
**Описание**: Расширенная информация о пользователе
**Поля**:
- `user` (OneToOneField to User): Связь со стандартной моделью User
- `preferred_emotions` (ManyToManyField to Emotion): Предпочитаемые эмоции
- `notification_frequency` (CharField): Частота уведомлений (daily/weekly)
- `email_notifications` (BooleanField): Включены ли email-уведомления
- `telegram_id` (CharField): ID Telegram для уведомлений

### Модель 5: Subscription (Подписка пользователя)
**Описание**: Подписка на получение уведомлений о новых фильмах
**Поля**:
- `user` (ForeignKey to User): Пользователь
- `emotion` (ForeignKey to Emotion): Эмоция для отслеживания
- `min_intensity` (IntegerField): Минимальная интенсивность
- `is_active` (BooleanField): Активна ли подписка
- `created_at` (DateTimeField): Дата создания
- `last_notified` (DateTimeField): Дата последнего уведомления

### Модель 6: Notification (Уведомление)
**Описание**: Уведомления для пользователей
**Поля**:
- `user` (ForeignKey to User): Получатель
- `film` (ForeignKey to Film): Связанный фильм
- `emotion` (ForeignKey to Emotion): По какой эмоции пришло уведомление
- `message` (TextField): Текст уведомления
- `is_read` (BooleanField): Прочитано ли
- `sent_via_email` (BooleanField): Отправлено ли на email
- `created_at` (DateTimeField): Дата создания

## 4. Ключевой функционал (User Stories)
1. **Эмоциональный поиск**: Пользователь выбирает одну или несколько эмоций и их интенсивность, система рекомендует фильмы с соответствующим эмоциональным профилем
2. **Аналитика эмоций**: На странице фильма отображается радиальная диаграмма (Plotly/Chart.js) с эмоциональным профилем
3. **Персональные подписки**: Пользователь подписывается на уведомления о новых фильмах с эмоцией "Радость" и интенсивностью от 7/10
4. **Управление уведомлениями**: Система ежедневно проверяет новые фильмы и отправляет email/tg уведомления подписчикам
5. **Административная панель**: Админ может загружать фильмы через CSV и оценивать их эмоциональный профиль

## 5. Внешние интеграции и аналитика
**Интеграции**:
- Email рассылка через SMTP
- S3 хранилище для изображений

## 6. Технический стек
- Python 3.11+, Django 5.2
- PostgreSQL
- Celery + Redis для фоновых задач (отправка уведомлений)
- Django REST Framework
- Bootstrap 5 для интерфейса
- Docker